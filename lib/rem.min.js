var f=void 0,g=!0,i=null,m=!1;function o(){return function(){}}
var r=function(){var a=0,b,c,d=this;return{get:function(e,j,h,l){l||(l=h,h=g);var k="";if(j)for(c in k="?",j=j||{},j)j.hasOwnProperty(c)&&(k+=encodeURIComponent(c)+"="+encodeURIComponent(j[c])+"&");var n="json"+ ++a;d[n]=function(a){l(a);try{delete d[n]}catch(b){}d[n]=i};var e=e+k+(h?"callback="+n:""),q=document.createElement("script"),C=m;q.src=e;q.async=g;q.onload=q.onreadystatechange=function(){if(!C&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){C=g;q.onload=q.onreadystatechange=
i;q&&q.parentNode&&q.parentNode.removeChild(q)}};b||(b=document.getElementsByTagName("head")[0]);b.appendChild(q);return n},fa:function(){return"json"+(a+1)}}}();var s;s==i&&(s={});s.U=function(a,b){if(a!=i&&b!=i)for(var c in b)a[c]=b[c]};
s.U(s,{e:function(a){if(a==i)return"";if(a instanceof Array){for(var b="";0<a.length;++a)""!=b&&(b+="&"),b+=s.e(a[0]);return b}a=encodeURIComponent(a);a=a.replace(/\!/g,"%21");a=a.replace(/\*/g,"%2A");a=a.replace(/\'/g,"%27");a=a.replace(/\(/g,"%28");return a=a.replace(/\)/g,"%29")},O:function(a){a!=i&&(a=a.replace(/\+/g," "));return decodeURIComponent(a)},t:function(a){if(a==i)return[];if("object"!=typeof a)return s.A(a+"");if(a instanceof Array)return a;var b=[],c;for(c in a)b.push([c,a[c]]);return b},
l:function(a){if(a==i)return{};if("object"!=typeof a)return s.l(s.A(a+""));if(a instanceof Array){for(var b={},c=0;c<a.length;++c){var d=a[c][0];b[d]===f&&(b[d]=a[c][1])}return b}return a},getParameter:function(a,b){if(a instanceof Array)for(var c=0;c<a.length;++c){if(a[c][0]==b)return a[c][1]}else return s.l(a)[b];return i},da:function(a){for(var b="",a=s.t(a),c=0;c<a.length;++c){var d=a[c][1];d==i&&(d="");""!=b&&(b+="&");b+=s.e(a[c][0])+"="+s.e(d)}return b},A:function(a){for(var b=[],a=a.split("&"),
c=0;c<a.length;++c){var d=a[c];if(""!=d){var e=d.indexOf("="),j;0>e?(j=s.O(d),d=i):(j=s.O(d.substring(0,e)),d=s.O(d.substring(e+1)));b.push([j,d])}}return b},setParameter:function(a,b,c){var d=a.g;if(d instanceof Array){for(a=0;a<d.length;++a)d[a][0]==b&&(c===f?d.splice(a,1):(d[a][1]=c,c=f));c!==f&&d.push([b,c])}else d=s.l(d),d[b]=c,a.g=d},Db:function(a,b){for(var c=s.t(b),d=0;d<c.length;++d)s.setParameter(a,c[d][0],c[d][1])},mb:function(a,b){a.method==i&&(a.method="GET");var c=s.l(a.g);c.tb==i&&
s.setParameter(a,"oauth_consumer_key",b.qb||"");c.xb==i&&b.n!=i&&s.setParameter(a,"oauth_token",b.n);c.yb==i&&s.setParameter(a,"oauth_version","1.0");c.wb==i&&s.setParameter(a,"oauth_timestamp",s.timestamp());c.ub==i&&s.setParameter(a,"oauth_nonce",s.D(6));s.b.K(a,b)},bb:function(a){s.setParameter(a,"oauth_timestamp",s.timestamp());s.setParameter(a,"oauth_nonce",s.D(6))},gb:function(a,b){newURL=a;if(b!=i){var c=s.da(b);0<c.length&&(newURL=0>a.indexOf("?")?newURL+"?":newURL+"&",newURL+=c)}return newURL},
rb:function(a,b){for(var c='OAuth realm="'+s.e(a)+'"',d=s.t(b),e=0;e<d.length;++e){var j=d[e],h=j[0];0==h.indexOf("oauth_")&&(c+=","+s.e(h)+'="'+s.e(j[1])+'"')}return c},Da:function(a){var a=a||"oauth_timestamp",b=document.getElementsByTagName("script");if(b!=i&&b.length&&(b=b[b.length-1].src)){var c=b.indexOf("?");0>c||(parameters=s.l(s.A(b.substring(c+1))),a=parameters[a],a!=i&&s.Ca(a))}},Ca:function(a){s.sa=1E3*a-(new Date).getTime()},sa:0,timestamp:function(){return Math.floor(((new Date).getTime()+
s.sa)/1E3)},D:function(a){for(var b=s.D.ta,c="",d=0;d<a;++d)var e=Math.floor(Math.random()*b.length),c=c+b.substring(e,e+1);return c}});s.D.ta="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";s.Ga=function(a){var b=s,c=b.SignatureMethod;b.SignatureMethod=a;if(a!=i&&c!=i)for(var d in c)"prototype"!=d&&(a[d]=c[d])};s.Ga(o());
s.U(s.b.prototype,{K:function(a){var b=s.b.La(a),b=this.Ma(b);s.setParameter(a,"oauth_signature",b);return b},Na:function(a,b){this.key=s.e(b.ya!=i&&9<a.length&&"-Accessor"==a.substring(a.length-9)?b.ya:b.Ba)+"&"+s.e(b.o)}});
s.U(s.b,{K:function(a,b){var c=s.l(a.g).vb;if(c==i||""==c)c="HMAC-SHA1",s.setParameter(a,"oauth_signature_method",c);s.b.Ra(c,b).K(a)},Ra:function(a,b){var c=s.b.M[a];if(c!=i){var d=new c;d.Na(a,b);return d}var c=Error("signature_method_rejected"),e="";for(d in s.b.M)""!=e&&(e+="&"),e+=s.e(d);c.sb=e;throw c;},M:{},pa:function(a,b){for(var c=0;c<a.length;++c)s.b.M[a[c]]=b},ja:function(a){function b(){c.call(this)}var c=s.b;b.prototype=new c;b.prototype.Ma=a;return b.prototype.constructor=b},La:function(a){var b=
a.action,c=b.indexOf("?");if(0>c)c=a.g;else for(var c=s.A(b.substring(c+1)),d=s.t(a.g),e=0;e<d.length;++e)c.push(d[e]);return s.e(a.method.toUpperCase())+"&"+s.e(s.b.Ta(b))+"&"+s.e(s.b.Sa(c))},Ta:function(a){var b=s.b.Za(a),a=b.protocol.toLowerCase(),c=b.jb.toLowerCase();if("http"==a&&80==b.port||"https"==a&&443==b.port){var d=c.lastIndexOf(":");0<=d&&(c=c.substring(0,d))}(b=b.path)||(b="/");return a+"://"+c+b},Za:function(a){for(var b="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),
a=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(a),c={},d=14;d--;)c[b[d]]=a[d]||"";return c},Sa:function(a){if(a==i)return"";for(var b=s.t(a),a=[],c=0;c<b.length;++c){var d=b[c];"oauth_signature"!=d[0]&&a.push([s.e(d[0])+" "+s.e(d[1]),d])}a.sort(function(a,b){return a[0]<b[0]?-1:a[0]>b[0]?1:0});b=[];for(c=0;c<a.length;++c)b.push(a[c][1]);return s.da(b)}});s.b.pa(["PLAINTEXT","PLAINTEXT-Accessor"],s.b.ja(function(){return this.key}));
s.b.pa(["HMAC-SHA1","HMAC-SHA1-Accessor"],s.b.ja(function(a){t="=";var b=this.key,c=u(b);16<c.length&&(c=v(c,b.length*w));for(var d=Array(16),b=Array(16),e=0;16>e;e++)d[e]=c[e]^909522486,b[e]=c[e]^1549556828;a=v(d.concat(u(a)),512+a.length*w);a=v(b.concat(a),672);c="";for(b=0;b<4*a.length;b+=3){d=(a[b>>2]>>8*(3-b%4)&255)<<16|(a[b+1>>2]>>8*(3-(b+1)%4)&255)<<8|a[b+2>>2]>>8*(3-(b+2)%4)&255;for(e=0;4>e;e++)c=8*b+6*e>32*a.length?c+t:c+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>
6*(3-e)&63)}return c}));try{s.Da()}catch(aa){};var t="",w=8;
function v(a,b){a[b>>5]|=128<<24-b%32;a[(b+64>>9<<4)+15]=b;for(var c=Array(80),d=1732584193,e=-271733879,j=-1732584194,h=271733878,l=-1009589776,k=0;k<a.length;k+=16){for(var n=d,q=e,C=j,Y=h,Z=l,p=0;80>p;p++){c[p]=16>p?a[k+p]:(c[p-3]^c[p-8]^c[p-14]^c[p-16])<<1|(c[p-3]^c[p-8]^c[p-14]^c[p-16])>>>31;var $=x(x(d<<5|d>>>27,20>p?e&j|~e&h:40>p?e^j^h:60>p?e&j|e&h|j&h:e^j^h),x(x(l,c[p]),20>p?1518500249:40>p?1859775393:60>p?-1894007588:-899497514)),l=h,h=j,j=e<<30|e>>>2,e=d,d=$}d=x(d,n);e=x(e,q);j=x(j,C);h=
x(h,Y);l=x(l,Z)}return[d,e,j,h,l]}function x(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}function u(a){for(var b=[],c=(1<<w)-1,d=0;d<a.length*w;d+=w)b[d>>5]|=(a.charCodeAt(d/w)&c)<<32-w-d%32;return b};(function(){var a={},b=window,c=b.document,d;a.disabled=m;a.set=o();a.get=o();a.remove=o();a.clear=o();a.Hb=function(b,c){var d=a.get(b);"undefined"==typeof d&&(d={});c(d);a.set(b,d)};a.T=function(a){return JSON.stringify(a)};a.P=function(a){return"string"!=typeof a?f:JSON.parse(a)};var e;try{e="localStorage"in b&&b.localStorage}catch(j){e=m}if(e)d=b.localStorage,a.set=function(b,c){if(c===f)return a.remove(b);d.setItem(b,a.T(c))},a.get=function(b){return a.P(d.getItem(b))},a.remove=function(a){d.removeItem(a)},
a.clear=function(){d.clear()};else{var h;try{h="globalStorage"in b&&b.globalStorage&&b.globalStorage[b.location.hostname]}catch(l){h=m}if(h)d=b.globalStorage[b.location.hostname],a.set=function(b,c){if(c===f)return a.remove(b);d[b]=a.T(c)},a.get=function(b){return a.P(d[b]&&d[b].value)},a.remove=function(a){delete d[a]},a.clear=function(){for(var a in d)delete d[a]};else if(c.documentElement.addBehavior){var k,n;try{n=new ActiveXObject("htmlfile"),n.open(),n.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></frame>'),
n.close(),k=n.Ib.frames[0].document,d=k.createElement("div")}catch(q){d=c.createElement("div"),k=c.body}b=function(b){return function(){var c=Array.prototype.slice.call(arguments,0);c.unshift(d);k.appendChild(d);d.addBehavior("#default#userData");d.load("localStorage");c=b.apply(a,c);return k.removeChild(d),c}};a.set=b(function(b,c,d){if(d===f)return a.remove(c);b.setAttribute(c,a.T(d));b.save("localStorage")});a.get=b(function(b,c){return a.P(b.getAttribute(c))});a.remove=b(function(a,b){a.removeAttribute(b);
a.save("localStorage")});a.clear=b(function(a){var b=a.XMLDocument.documentElement.attributes;a.load("localStorage");for(var c=0,d;d=b[c];c++)a.removeAttribute(d.name);a.save("localStorage")})}}try{a.set("__storejs__","__storejs__"),"__storejs__"!=a.get("__storejs__")&&(a.disabled=g),a.remove("__storejs__")}catch(C){a.disabled=g}"undefined"!=typeof module?module.Ja=a:"function"==typeof define&&define.ib?define(a):this.Eb=a})();var y={m:function(a,b){a.Gb=b;a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:m}})}};y.va=z;function z(){}function A(a,b){return a.hasOwnProperty.call(a.w||(a.w={}),b)?a.w[b]:a.w[b]=[]}z.prototype.d=z.prototype.addListener=function(a,b){0!==this.xa&&A(this,a).push(b)>(this.xa||10)&&console&&console.warn("Possible EventEmitter memory leak detected. "+this.w[a].length+" listeners added. Use emitter.setMaxListeners() to increase limit.");this.c("newListener",a,b);return this};
z.prototype.removeListener=function(a,b){var c;-1!=(c=A(this,a).indexOf(b))&&A(this,a).splice(c,1);return this};z.prototype.c=function(a){for(var b=Array.prototype.slice.call(arguments,1),c=0,d=A(this,a).slice();c<d.length;c++)d[c].apply(this,b);return d.length};y.j=B;y.m(B,z);function B(){}
function D(a,b){function c(a){b.writable&&m===b.write(a)&&k.pause&&k.pause()}function d(){k.oa&&k.I&&k.I()}function e(){n||(n=g,b.end())}function j(){n||(n=g,"function"===typeof b.Ia&&b.Ia())}function h(a){l();if(0===A(this,"error").length)throw a;}function l(){k.removeListener("data",c);b.removeListener("drain",d);k.removeListener("end",e);k.removeListener("close",j);k.removeListener("error",h);b.removeListener("error",h);k.removeListener("end",l);k.removeListener("close",l);b.removeListener("end",
l);b.removeListener("close",l)}var k=a,n=m;k.d("data",c);b.d("drain",d);k.d("end",e);k.d("close",j);k.d("error",h);b.d("error",h);k.d("end",l);k.d("close",l);b.d("end",l);b.d("close",l);b.c("pipe",k)}y.ba=function(a,b){var c=[];a.d("data",function(a){c.push(a)});a.d("end",function(){b(c.join(""))})};
y.Ya=function(a){var b=document.createElement("a");b.href=-1==a.indexOf(":")||-1<a.indexOf("?")&&a.indexOf(":")>a.indexOf("?")||-1<a.indexOf("#")&&a.indexOf(":")>a.indexOf("#")?"fake:"+a:a;return{protocol:b.protocol&&"fake:"!=b.protocol?b.protocol:i,h:b.h||i,hostname:b.hostname||i,port:b.port||i,pathname:b.pathname,f:y.r.parse(b.search||""),hash:b.hash?decodeURIComponent(b.hash.substr(1)):i}};
y.Ka=function(a){var b=document.createElement("a");b.href="http://example.com";b.protocol=a.protocol||"http:";b.h=a.h;b.hostname=a.hostname;a.port&&(b.port=a.port);b.pathname=a.pathname;y.r.stringify(a.f)&&(b.search=y.r.stringify(a.f));a.hash&&(b.hash=a.hash);return b.href};
y.r={parse:function(a){for(var b={},a=a.replace(/^\?/,"").replace(/\+/g," ").split("&"),c=0,d=a.length,e;c<d;c++)a[c]&&(e=a[c].split("="),b[decodeURIComponent(e[0])]=decodeURIComponent(e[1]));return b},stringify:function(a){var b=[],c;for(c in a)b.push(encodeURIComponent(c)+(a[c]==i?"":"="+encodeURIComponent(a[c])));return b.join("&")}};y.m(E,y.j);
function E(a,b){var c=0;this.url=a;this.statusText=b.statusText;this.L=b.status;b.onreadystatechange=function(){3==b.readyState&&(this.c("data",b.responseText.substr(c)),c=b.responseText.length);4==b.readyState&&(c<b.responseText.length&&this.c("data",b.responseText.substr(c)),this.c("end"))}.bind(this)}function ba(a){return a.replace(/(?:^|\b)\w/g,function(a){return a.toUpperCase()})}
y.ab=function(a,b){var c=String(a.url),d=new XMLHttpRequest;d.onreadystatechange=function(){if(2==d.readyState){var a=new E(c,d);b(i,a)}};var e="accept-charset accept-encoding access-control-request-headers access-control-request-method connection content-length cookie cookie2 content-transfer-encoding date dnt expect host keep-alive origin referer te trailer transfer-encoding upgrade user-agent via".split(" ");d.open(a.method,c,g);for(var j in a.headers)-1==e.indexOf(j)&&d.setRequestHeader(ba(j),
a.headers[j]);var e=new y.j,h=[];e.Jb=g;e.write=function(a){h.push(a)};e.end=function(a){a&&h.push(a);d.send(h.length?h.join(""):i)};return e};y.Q=function(){var a=Array.prototype.slice.call(arguments),b=document.createElement("a");b.href=window.location.href;b.pathname=a.join("/").replace(/\/+/g,"/");return b.pathname.substr(a[0]&&"/"==a[0][0]?0:1)};
if("undefined"!=typeof window.DOMParser)y.la=function(a,b){b((new window.DOMParser).parseFromString(a,"text/xml"))};else if("undefined"!=typeof window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM"))y.la=function(a,b){var c=new window.ActiveXObject("Microsoft.XMLDOM");c.async="false";c.loadXML(a);b(c)};else throw Error("No XML parser found");y.Pa=function(){throw Error("Cannot synchronously load manifests in the browser. Use rem.loadAsync instead.");};
y.Oa=function(a,b){var c=a.match(/^\.\/|\/\//)?a:"http://www.remlib.org/m/"+y.Q("/",a).replace(/^\//,"");F.R(c).get(b)};y.ga=function(a){return"[object Array]"===Object.prototype.toString.call(a)};y.nb=function(a){return a.join("")};y.ka=function(a){setTimeout(a,0)};y.Ab=function(a,b){var c=prompt(a);setTimeout(function(){b(c===i,c)})};
y.na=function(a,b,c){if(!b.options.key&&!store.get("rem:"+b.a.id+":key")){if(!(a=prompt("API key: ")))return;b.options.key=a;store.set("rem:"+b.a.id+":key",a);if(!(a=prompt("API secret: ")))return;b.options.qa=a;store.set("rem:"+b.a.id+":secret",a)}else b.options.key||(b.options.key=store.get("rem:"+b.a.id+":key"),b.options.qa=store.get("rem:"+b.a.id+":secret"));c(b)};y.ma=function(a,b,c,d){a.$a(b,c,d)};
y.Va=function(a){!a.a.Ea&&!a.a.ha&&console.error("Warning: API does not specify explicit support for JSONP or CORS. Only same-origin requests allowed.");!a.a.Ea&&a.a.ha&&(a.v(function(b,c){if("GET"!=b.method)throw Error("Only GET calls can be made from a JSONP API.");b.url.f[a.a.ha]=r.fa();c()}),a.send=function(a,c,d){var e=String(a.url);r.get(e,i,m,function(a){var b=new y.j;b.url=e;b.statusText="";b.L=200;d(i,b);b.c("data",JSON.stringify(a));b.c("end")});return new y.j})};function G(a){function b(){return b.call.apply(b,arguments)}b.__proto__=a;return b}function H(a){return JSON.parse(JSON.stringify(a))}function I(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&b[c]!=i&&(a[c]=b[c]);return a}function J(){}J.prototype.v=function(a){(this.X||(this.X=[])).push(a);return this};
J.prototype.Qa=function(){function a(){0==d.length?y.ka(c):d.shift().apply(this,b.concat([a.bind(this)]))}var b=Array.prototype.slice.call(arguments),c=b.pop(),d=(this.X||[]).slice();a.call(this)};var K="undefined"!==typeof module&&module.Ja?"node":"browser";"node"==K&&(y=require("./node/env"));var F="node"==K?exports:this.Bb={};F.userAgent="Mozilla/5.0 (compatible; REMbot/1.0; +http://remlib.org/)";F.q=y;y.m(L,y.j);
function L(){this.s=[];this.oa=this.writable=this.paused=g;this.ended=this.ca=this.Z=m;this.index=0}L.prototype.pause=function(){this.paused=g};L.prototype.I=function(){for(this.paused=m;this.index<this.s.length;)this.c("data",this.s[this.index++]);this.Z||(this.s=[],this.index=0);this.ended&&!this.ca&&this.end()};L.prototype.write=function(a){this.s.push(a);this.paused||this.c("data",this.Z?a:this.s.pop());return g};
L.prototype.end=function(a){a&&this.write(a);this.ended=g;this.paused||(this.c("end"),this.ca=g)};y.m(M,y.va);
function M(){this.input=new L;this.writable=g;this.u=new L;this.oa=g;["error","close","drain","pipe"].forEach(function(a){this.d(a,this.input.c.bind(this.input,a))}.bind(this));["write","end"].forEach(function(a){this[a]=this.input[a].bind(this.input)}.bind(this));["error","close","data","end"].forEach(function(a){this.u.d(a,this.c.bind(this,a))}.bind(this));["pause","resume","pipe"].forEach(function(a){this[a]=this.u[a].bind(this.u)}.bind(this))}
F.ra={R:function(a){return JSON.stringify(a).replace(/[\u007f-\uffff]/g,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})},form:function(a){return y.r.stringify(a)}};
F.i={Fb:function(a,b){b(i,a)},lb:function(a,b){y.ba(a,function(a){b(i,a)})},text:function(a,b){y.ba(a,function(a){b(i,String(a).replace(/^\uFEFF/,""))})},R:function(a,b){F.i.text(a,function(a,d){if(a||!d.length)return b(a);try{var e=JSON.parse(String(d))}catch(j){return a=new SyntaxError("Could not parse JSON response: "+j.message+"\n"+d),a.stack=j.stack,b(a,i)}b(i,e)})},xml:function(a,b){F.i.text(a,function(a,d){if(a||!d.length)return b(a);var e=m;try{y.la(d,function(a){e=g;b(i,a)})}catch(j){if(e)throw j;
a=new SyntaxError("Could not parse XML response: "+j.message+"\n"+d);a.stack=j.stack;b(a,i)}})}};F.URL=N;function N(a){this.pathname=this.port=this.hostname=this.h=this.protocol=f;this.f={};this.hash=f;a&&this.parse(a)}N.prototype.toString=function(){return y.Ka(this)};function O(a,b){a.protocol=b.protocol||a.protocol;a.h=b.h||a.h;a.hostname=b.hostname||a.hostname;a.port=b.port||a.port;a.pathname=b.pathname||a.pathname;I(a.f,b.f);a.hash=b.hash||a.hash}N.prototype.parse=function(a){O(this,y.Ya(a))};
F.eb=P;function P(){this.method="GET";this.headers={};this.url=new N;this.body=i}P.prototype.send=function(a,b){return y.ab(this,b)};function Q(a,b,c,d){this.url=a;this.Ha=b||"json";this.$=d;this.H=c;this.J=function(a,b){b()}}Q.prototype.v=function(a){var b=this.J;this.J=function(c,d){b(c,function(){a(c,d)})};return this};Q.prototype.headers=function(a){return this.v(function(b,c){for(var d in a)b.headers[d]=a[d];c()})};
[["get","GET"],["head","HEAD"],["del","DELETE"]].forEach(function(a){var b=a[1];Q.prototype[a[0]]=function(a,d){"function"==typeof a&&(d=a,a=i);var e=new P;O(e.url,this.url);e.method=b;e.H=this.H;I(e.url.f,a||{});return this.$(e,this.J,d)}});
[["post","POST"],["put","PUT"],["patch","PATCH"]].forEach(function(a){var b=a[1];Q.prototype[a[0]]=function(a,d,e,j){var h=Array.prototype.slice.call(arguments),l,k,n,q;"function"==typeof h[h.length-1]&&(q=h.pop());2<=h.length&&"object"==typeof h[0]&&(l=h.shift());2==h.length&&(k=h.shift());n=h.shift();h=new P;O(h.url,this.url);h.method=b;h.wa=k!=i;h.method=b;I(h.url.f,l||{});if(n){l=h;k=k||this.Ha;if("object"==typeof n&&!y.ga(n)){if("form"==k||"application/x-www-form-urlencoded"==k)k="application/x-www-form-urlencoded",
n=F.ra.form(n);if("json"==k||"application/json"==k)k="application/json",n=F.ra.R(n)}l.headers["content-length"]=n.length;l.headers["content-type"]=k;l.body=n}return this.$(h,this.J,q)}});function R(a){this.i={};Object.keys(F.i).forEach(function(a){this.i[a]=F.i[a];this[a]=function(){return this.Y.bind(this,a).apply(this,arguments)}}.bind(this));this.options={B:"json",H:g};a&&this.N(a);this.v(function(a,c){a.headers["user-agent"]=a.headers["user-agent"]||F.userAgent;c()})}
function ca(a,b){return function(c,d){a.debug&&(d?console.error(String(d.L).green,("[type: "+String(d.headers["content-type"])+"]").C,("[body: "+String(d.headers["content-length"])+"]").C):console.error("ERROR".green,String(c).C));b.apply(this,arguments)}}y.m(R,J);R.prototype.N=function(a){I(this.options,a);return this};
R.prototype.Y=function(a){var b=Array.prototype.slice.call(arguments,1),c="object"==typeof b[b.length-1]?b.pop():{},b=(-1!=(b[0]||"").indexOf("//")?b.shift():b.length?"/":"")+(b.length?y.Q.apply(i,b.map(String)):""),b=new N(b);I(b.f,c);return new Q(b,this.options.V,this.options.H,function(b,c,j){function h(){b.body&&!b.wa&&(b.headers["content-type"]=b.body,delete b.headers["content-length"],b.body=i)}var l=new M;l.d("pipe",function n(){h.apply(this,arguments);this.removeListener("pipe",n)});y.ka(l.removeListener.bind(l,
"pipe",h));this.Qa(b,function(){c(b,function(){this.debug&&console.error(String(b.method).green,String(b.url).C,b.body?("[body: "+(b.body.length?b.body.length+" bytes":"stream")+"]").C:"");this.send(b,l,ca(this,function(b,c){l.u.I();D(c,l.u);l.c("response",c);this.i[a](c,function(a,b){var d=a||(400<=c.L?c.L:0);j&&j.call(this,d,b,c);l.c("return",d,b,c)})}.bind(this)))}.bind(this))}.bind(this));return l}.bind(this))};R.prototype.call=function(){return this.Y.bind(this,this.options.B).apply(this,arguments)};
R.prototype.send=function(a,b,c){c=a.send(this.hb,c);!a.body&&-1!=["PUT","POST","PATCH"].indexOf(a.method)?(D(b.input,c),b.input.I()):(a.body!=i&&c.write(a.body),c.end())};
function S(a,b){this.a=a;this.a.Aa=this.a.Aa||["key","secret"];R.call(this,b);this.v(function(a,b){if(this.a.z){var e=a.url.pathname.replace(/^(?!\/)/,"/");if(y.ga(this.a.z)){var j="";this.a.z.some(function(a){if(e.match(RegExp(a[0])))return j=a[1],g})}else j=String(this.a.z);if(j&&(a.url.protocol||a.url.hostname))throw Error("Full URL request does not match API base URL: "+String(a.url));O(a.url,new N(j));a.url.pathname=y.Q(a.url.pathname,e)}this.a.za&&(a.url.pathname=this.a.za+a.url.pathname);this.a.cb&&
(a.url.pathname+=this.a.cb);if(this.a.aa){var h=this.a.aa,l;for(l in h)a.url.f[l]=this.options[this.a.aa[l]]}if(this.a.Xa)for(l in h=this.a.Xa,h)a.url.f[l]=h[l];b()}.bind(this))}y.m(S,R);S.prototype.N=function(a){I(this.options,a);if(this.a.ea){if(!this.a.ea[this.options.B])throw Error('Format "'+this.options.B+'" is not explicitly defined in this manifest. Please specify an available format this API supports.');I(this.a,this.a.ea[this.options.B])}this.options.V=this.options.V||this.a.V;return this};
S.prototype.ma=function(a,b){b||(b=a,a={});y.ma(F,this,a,b);return this};S.prototype.na=function(a){y.na(F,this,a);return this};F.ua=R;F.W=S;F.Fa=function(a){"string"==typeof a&&(a={z:a});a=G(new S(a,f));F.q.Va(a);return a};
function T(a,b,c,d){c=c=Number(c)||"*";if(!a||!a[c])if("*"==c&&a){if(c=Object.keys(a).sort().pop(),!a[c])throw Error("Unable to find API "+JSON.stringify(b)+" version "+JSON.stringify(Number(c))+'. For the latest API, use "*".');}else{if(a)throw Error("Unable to find API "+JSON.stringify(b)+" version "+JSON.stringify(Number(c))+'. For the latest API, use "*".');throw Error("Unable to find API "+JSON.stringify(b)+".");}a=a[c];a.version=c;return F.Fa(a).N(d)}
F.ob=function(a,b,c){return T(y.Pa(),a,b,c)};F.pb=function(a,b,c,d){d||(d=c,c={});y.Oa(a,function(e,j){e?d(e):d(i,T(j,a,b,c))})};var U=new F.ua;Object.keys(F.i).forEach(function(a){F[a]=function(){return U[a].apply(U,arguments)}});"node"==K&&(require("./node/oauth"),require("./node/basic"));function G(a){function b(){return b.call.apply(b,arguments)}b.__proto__=a;return b}function H(a){return JSON.parse(JSON.stringify(a))}function I(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&b[c]!=i&&(a[c]=b[c]);return a}
function V(a,b,c,d){b.n=b.n||a.options.G;b.o=b.o||a.options.F;var e={Ba:a.options.qa},a={action:b.url,method:"GET",g:[["oauth_consumer_key",a.options.key],["oauth_signature_method","HMAC-SHA1"]]};b.n!=g&&a.g.push(["oauth_token",b.n]);b.o!=g&&(e.o=b.o);a.g.push.apply(a.g,c);a.g.push(["callback",r.fa()]);s.bb(a);s.b.K(a,e);r.get(a.action,s.l(a.g),m,d)}function W(a,b){F.W.apply(this,arguments);this.p=this.a.h}F.q.m(W,F.W);
W.prototype.send=function(a,b,c){var b=[],d;for(d in a.f)b.push([d,a.f[d]]);a=String(a.url).replace(/\?.*$/,"");V(this,{url:a},b,function(a){var b=new F.q.j;c(i,b);b.c("data",JSON.stringify(a));b.c("end")});return new F.q.j};function X(a,b){this.k=a;this.p=this.k.a.h;this.Wa=!b;if(!b&&!this.p.Wa)throw Error("Out-of-band OAuth for this API is not permitted.");this.S=b||this.p.zb||f}
X.prototype.start=function(a){V(this.k,{url:this.p.Cb,n:g,o:g},[],function(b){b=F.q.r.parse(b);a(this.p.kb+"?oauth_token="+b.oauth_token+"&oauth_callback="+this.S,b.oauth_token,b.oauth_token_secret,b)}.bind(this))};
X.prototype.complete=function(a,b,c){V(this.k,{url:this.p.fb,n:a,o:b},[],function(a){a=F.q.r.parse(a);store.set("rem:oauth:"+this.k.a.id+":accessToken",a.oauth_token);store.set("rem:oauth:"+this.k.a.id+":accessSecret",a.oauth_token_secret);this.ia({G:a.oauth_token,F:a.oauth_token_secret},function(a){c(i,a)})}.bind(this))};X.prototype.ia=function(a,b){var c=H(this.k.options);c.G=a.G;c.F=a.F;c.S=this.S;b(G(new W(this.k.a,c)))};F.Ua=function(a,b){return new X(a,b)};
F.$a=function(){var a=Array.prototype.slice.call(arguments),b=a.pop(),c=a.shift();a.pop();a=window.location.href.replace(/[\?\#].*$/,"");a=F.Ua(c,a);store.get("rem:oauth:"+c.a.id+":accessToken")&&store.get("rem:oauth:"+c.a.id+":accessSecret")?a.ia({G:store.get("rem:oauth:"+c.a.id+":accessToken"),F:store.get("rem:oauth:"+c.a.id+":accessSecret")},function(a){b(i,a)}):-1<window.location.search.indexOf("oauth_token")&&store.get("rem:oauth:"+c.a.id+":requestToken")&&store.get("rem:oauth:"+c.a.id+":requestSecret")?
a.complete(store.get("rem:oauth:"+c.a.id+":requestToken"),store.get("rem:oauth:"+c.a.id+":requestSecret"),b):a.start(function(a,b,j){store.set("rem:oauth:"+c.a.id+":requestToken",b);store.set("rem:oauth:"+c.a.id+":requestSecret",j);window.location.href=a}.bind(this))};
